"use strict";(self.webpackChunksensor_manager_complete=self.webpackChunksensor_manager_complete||[]).push([[37],{15111:function(J,E,e){e.r(E),e.d(E,{default:function(){return se}});var w=e(15009),r=e.n(w),A=e(97857),c=e.n(A),M=e(99289),S=e.n(M),C=e(5574),T=e.n(C),L=e(18642),D=e(53589),s=e(92016);function I(v,o){return x.apply(this,arguments)}function x(){return x=S()(r()().mark(function v(o,i){return r()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,s.request)("/api/login/captcha",c()({method:"GET",params:c()({},o)},i||{})));case 1:case"end":return P.stop()}},v)})),x.apply(this,arguments)}var R=e(87547),F=e(94149),n=e(24454),l=e(44537),h=e(5966),a=e(16434),Q=e(63434),X=e(40056),Y=e(9361),_=e(50960),q=e(2453),ee=e(19803),W=e(67294),te=e(67610),ae=e(73935),t=e(85893),U=(0,ee.kc)(function(v){var o=v.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:o.colorPrimaryActive}},lang:{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:o.borderRadius,":hover":{backgroundColor:o.colorBgTextHover}},container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",overflow:"auto",background:"#ffffff",margin:"0 auto",transition:"all 0.3s",color:"#ffffff",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.5)",padding:"20px"}}}),pe=function(){var o=U(),i=o.styles;return _jsxs(_Fragment,{children:[_jsx(AlipayCircleOutlined,{className:i.action},"AlipayCircleOutlined"),_jsx(TaobaoCircleOutlined,{className:i.action},"TaobaoCircleOutlined"),_jsx(WeiboCircleOutlined,{className:i.action},"WeiboCircleOutlined")]})},me=function(){var o=U(),i=o.styles;return _jsx("div",{className:i.lang,"data-lang":!0,children:SelectLang&&_jsx(SelectLang,{})})},k=function(o){var i=o.content;return(0,t.jsx)(X.Z,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},re=function(){var o=(0,W.useState)({}),i=T()(o,2),Z=i[0],P=i[1],ne=Y.Z.useToken(),B=ne.token,oe=(0,W.useState)("account"),z=T()(oe,2),$=z[0],ue=z[1],ie=U(B),le=ie.styles,p=(0,s.useIntl)(),N=(0,s.useModel)("@@initialState"),y=N.initialState,de=N.setInitialState,ce=function(){var b=S()(r()().mark(function g(m){var j,f,d,H,O,V;return r()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,D.x4)(m);case 3:if(j=u.sent,!j.token){u.next=13;break}return u.next=7,y==null||(f=y.fetchUserInfo)===null||f===void 0?void 0:f.call(y);case 7:d=u.sent,d&&(0,ae.flushSync)(function(){localStorage.setItem("token",j.token),de(function(ge){return c()(c()({},ge),{},{currentUser:{name:m.username,avatar:d.avatar}})})}),H=new URL(window.location.href).searchParams,O=H.get("redirect"),V=y==null?void 0:y.loginPath,O&&!O.startsWith(V)?s.history.push(O):s.history.push("/etcd");case 13:u.next=18;break;case 15:u.prev=15,u.t0=u.catch(0),console.error("Login failed:",u.t0);case 18:case"end":return u.stop()}},g,null,[[0,15]])}));return function(m){return b.apply(this,arguments)}}(),G=Z.status,K=Z.type;return(0,t.jsxs)("div",{className:le.container,children:[(0,t.jsx)(s.Helmet,{children:(0,t.jsxs)("title",{children:[p.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",te.Z.title]})}),(0,t.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,t.jsxs)(l.U,{contentStyle:{maxWidth:"75vw",padding:"24px",backgroundColor:"#ffffff",border:"1px solid ".concat(B.colorBorder),borderRadius:B.borderRadius,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},logo:(0,t.jsx)("img",{alt:"logo",src:"/etcd.svg",style:{width:"clamp(500px, 35vw, 800px)",height:"auto",transition:"all 0.3s ease",margin:"30px 0",maxHeight:"35vh"}}),title:(0,t.jsx)("div",{style:{fontSize:"clamp(24px, 3vw, 32px)",color:"#2c3e50",fontWeight:600,textShadow:"1px 1px 2px rgba(0,0,0,0.1)",letterSpacing:"1px"},children:"Etcd V3 Editor"}),subTitle:p.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},onFinish:function(){var b=S()(r()().mark(function g(m){return r()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,ce(m);case 2:case"end":return f.stop()}},g)}));return function(g){return b.apply(this,arguments)}}(),children:[(0,t.jsx)(_.Z,{activeKey:$,onChange:ue,centered:!0}),G==="error"&&K==="account"&&(0,t.jsx)(k,{content:p.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),$==="account"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(R.Z,{style:{color:B.colorTextSecondary}})},placeholder:p.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D"}),rules:[{required:!0,message:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(h.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(F.Z,{style:{color:B.colorTextSecondary}})},placeholder:p.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801"}),rules:[{required:!0,message:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),G==="error"&&K==="mobile"&&(0,t.jsx)(k,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),$==="mobile"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.Z,{fieldProps:{size:"large",prefix:(0,t.jsx)(n.Z,{})},name:"mobile",placeholder:p.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,t.jsx)(a.Z,{fieldProps:{size:"large",prefix:(0,t.jsx)(F.Z,{})},captchaProps:{size:"large"},placeholder:p.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(g,m){return g?"".concat(m," ").concat(p.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):p.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var b=S()(r()().mark(function g(m){var j;return r()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,I({phone:m});case 2:if(j=d.sent,j){d.next=5;break}return d.abrupt("return");case 5:q.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return d.stop()}},g)}));return function(g){return b.apply(this,arguments)}}()})]}),(0,t.jsxs)("div",{style:{marginBottom:24},children:[(0,t.jsx)(Q.Z,{noStyle:!0,name:"autoLogin",children:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,t.jsx)("a",{style:{float:"right"},children:(0,t.jsx)(s.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,t.jsx)(L.$_,{})]})},se=re},53589:function(J,E,e){e.d(E,{IV:function(){return R},a1:function(){return T},gz:function(){return D},lg:function(){return I},x4:function(){return S}});var w=e(15009),r=e.n(w),A=e(99289),c=e.n(A),M=e(92016);function S(n){return C.apply(this,arguments)}function C(){return C=c()(r()().mark(function n(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,M.request)("/api/login",{method:"POST",data:l}));case 1:case"end":return a.stop()}},n)})),C.apply(this,arguments)}function T(n){return L.apply(this,arguments)}function L(){return L=c()(r()().mark(function n(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,M.request)("/api/etcd/put",{method:"POST",data:l}));case 1:case"end":return a.stop()}},n)})),L.apply(this,arguments)}function D(n){return s.apply(this,arguments)}function s(){return s=c()(r()().mark(function n(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",T(l));case 1:case"end":return a.stop()}},n)})),s.apply(this,arguments)}function I(n){return x.apply(this,arguments)}function x(){return x=c()(r()().mark(function n(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,M.request)("/api/etcd/list",l));case 1:case"end":return a.stop()}},n)})),x.apply(this,arguments)}function R(n){return F.apply(this,arguments)}function F(){return F=c()(r()().mark(function n(l){return r()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,M.request)("/api/etcd/delete",{method:"DELETE",params:l}));case 1:case"end":return a.stop()}},n)})),F.apply(this,arguments)}}}]);
